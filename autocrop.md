# Auto Crop Service

This service exposes an HTTP-based API for automatic computation of image crops, based on the AutoCrop2 library.


## API

`POST https://sensei.adobe.io/functions/autocrop`

Crop suggestions for a given image can be generated by sending JSON POST requests to `/api/autocrop` where:

* an `image` object provides either a URL string to the processed image, or a JSON object that presents the image

Example:

```json
{
  "image": {
    "uri": "https://cc-api-storage.adobe.io/id/urn:aaid:sc:abc",
    "headers": {
      "Authorization": "Bearer <token>",
      "X-Api-Key": ""
    }
  }
}
```

A `blocking` GET param query can be used to determine whether the request should be blocked until result is available, or an activation ID is returned for retrieving result at a later time.

On successful completion, the server returns a JSON object with an activation ID if `blocking` is false or not defined, or an array of generated crop suggestions (ordered by overall score) if `blocking=true`.

Example:

```json
{
  "cropSuggestions": [
    {
      "xMin": 12,
      "xMax": 933,
      "yMin": 51,
      "yMax": 665,
      "goodCandidate": true,
      "score": {
        "isComputed": true,
        "composition": 0.5272046327590942,
        "saliency": 0.999984622001648,
        "cutThrough": 0.5878231525421143,
        "saliencySparse": 1,
        "centerness": 0.03821255639195442,
        "objPenalty": 1.181644320487976,
        "overallScore": 128.6769389919098
      }
    },
    {
      "xMin": 80,
      "xMax": 990,
      "yMin": 0,
      "yMax": 682,
      "goodCandidate": true,
      "score": {
        "isComputed": true,
        "composition": 0.48188623785972595,
        "saliency": 1,
        "cutThrough": 0.6612163782119751,
        "saliencySparse": 1,
        "centerness": 0.332835853099823,
        "objPenalty": 1.1816644668579102,
        "overallScore": 128.66142010479786
      }
    },
    {
      "xMin": 93,
      "xMax": 912,
      "yMin": 25,
      "yMax": 639,
      "goodCandidate": true,
      "score": {
        "isComputed": true,
        "composition": 0.5162208676338196,
        "saliency": 0.9880324602127075,
        "cutThrough": 0.5803415179252625,
        "saliencySparse": 1,
        "centerness": 0.05272615700960159,
        "objPenalty": 1.181664228439331,
        "overallScore": 128.6557898310332
      }
    },
    {
      "xMin": 0,
      "xMax": 1023,
      "yMin": 8,
      "yMax": 583,
      "goodCandidate": true,
      "score": {
        "isComputed": true,
        "composition": 0.5152865052223206,
        "saliency": 0.9313555955886841,
        "cutThrough": 0.6267793774604797,
        "saliencySparse": 1,
        "centerness": 0.5885596871376038,
        "objPenalty": 1.1816564798355103,
        "overallScore": 128.64725550679543
      }
    }
  ],
  "rectsOfInterest": [
    {
      "xMin": 368,
      "xMax": 437,
      "yMin": 99,
      "yMax": 168,
      "isFace": true,
      "enabled": true,
      "rectOfInterestType": "kPreserve"
    },
    {
      "xMin": 675,
      "xMax": 740,
      "yMin": 103,
      "yMax": 168,
      "isFace": true,
      "enabled": true,
      "rectOfInterestType": "kPreserve"
    },
    {
      "xMin": 571,
      "xMax": 678,
      "yMin": 228,
      "yMax": 335,
      "isFace": true,
      "enabled": true,
      "rectOfInterestType": "kPreserve"
    }
  ],
}
```  

For getting activation result by ID, please see [Activation API](activation.md).
